
<div class="default">
    <br/>
    <br/>
    <div *ngIf="error">
        <H3>{{errorMessage}}</H3>
    </div>

    <mat-toolbar fxLayout="row" fxLayoutAlign.gt-sm="space-around center" fxLayoutGap.gt-sm="15vw">
        <div fxHide.gt-sm fxLayout="row" fxLayoutAlign="space-around center" fxFlex.lt-md="30">
            <mat-icon fxHide.gt-sm>menu_open</mat-icon>
            <a fxHide.gt-sm href="/"> <img src="assets/images/logo.png" class="logo-inverse" alt=""></a>
        </div>
        <div fxLayout="column" fxLayoutAlign="space-around center" fxFlex="15">
            <mat-icon >sort</mat-icon>
            <div uk-dropdown="pos: bottom-center;mode:click ">
                <mat-list fxLayout="column">
                    <mat-header  [ngStyle]="{'color': 'purple'}"> Catégories </mat-header>
                    <mat-list-item *ngFor = "let cat of categories" (change) = "checkCatFilters($event)">
                        <input type="checkbox" [checked]="false" [value]="cat._id"> {{cat.title}}
                    </mat-list-item>
                    <mat-divider ></mat-divider>
                    <mat-header  [ngStyle]="{'color': 'purple'}"> Relations </mat-header>
                    <mat-list-item *ngFor = "let rel of relations" (change) = "checkRelFilters($event)">
                        <input type="checkbox" [checked]="false" [value]="rel._id"> {{rel.title}}
                    </mat-list-item>
                    <mat-divider ></mat-divider>
                    <mat-header  [ngStyle]="{'color': 'purple'}"> Types </mat-header>
                    <mat-list-item *ngFor = "let type of ressourceTypes" (change) = "checkTypesFilters($event)">
                        <input type="checkbox" [checked]="false" [value]="type._id"> {{type.title}}
                    </mat-list-item>
                </mat-list>
                <button (click)="validFilters()" style="position: relative; ">Valider la séléction</button>
            </div>
        </div>
    </mat-toolbar>
        <mat-spinner *ngIf="isLoading" diameter="70" style="position: relative;" ></mat-spinner>
            <div *ngFor="let ress of ressources; let i = index" class="sl_group_list"> 
                <div>
                    <div class="post-heading">
                        <div class=" uk-grid-small uk-child-width-expand@s" uk-grid>
                            <div class="uk-card uk-card-body uk-card-body" >
                                <h3> {{ress.posterPseudo}} </h3>
                                <div  *ngFor="let cat of ress.category">
                                    <h5 class="uk-active">Catégorie : </h5>
                                    <h7>{{cat.title}}</h7>
                                </div>
                            </div>
                            <!-- <div class="uk-card uk-card-default uk-card-body">
                                
                            </div> -->
                            <div class="uk-card uk-card-default uk-card-body">
                                <h5 class="uk-active">Relations : </h5>

                                <div *ngFor=" let rel of ress.relation">
                                    
                                    <h7>{{rel.title}}</h7>
                                </div>
                                <hr class="uk-divider-icon">
                                <h5 class="uk-active">Types de ressource : </h5>
                                <div *ngFor=" let type of ress.ressourceType"> 
                                    <h7>{{type.title}}</h7>
                                </div>

                                </div>
                            </div>
                            <div >
                                <h4>{{ress.message}}</h4>
                            </div>


                        <div class="post-btn-action" *ngIf="account">
                            <span class="icon-more uil-ellipsis-h"></span>
                            <div class="mt-0 p-2" uk-dropdown="pos: bottom-left;mode:click ">
                                <ul class="uk-nav uk-dropdown-nav" style="text-align: center; margin:auto; padding : auto;">
                                    <li><a href="#"> <b> Signaler</b></a> </li>
                                    <li *ngIf="ress.posterId == account._id">
                                            <a (click) ="modifyRessource(ress._id)"> <b> Modifier</b></a> 
                                    </li>
                                    <li *ngIf="ress.posterId == account._id">
                                            <a (click) ="deletePost(ress._id)"><b> Supprimer</b></a> 
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <a (click) ="ressourceDetails(ress._id)">
                    <div>
                        <ng-container *ngIf="ress.picture;then IMG; else noIMG">
                        </ng-container>
                        <ng-template #IMG >
                            <p style="text-align:center"><img  [src]="ress.picture" alt=""  ></p>
                        </ng-template>
                        <ng-template #noIMG >
                            <p style="text-align:center"><img src="assets/images/post/img-1.jpg" alt=""></p>
                        </ng-template>
                    </div>
                    </a>
                    <div class="post-state" >
                        <div class="post-state-btns" *ngIf="liked"> 
                            <ng-container *ngIf="liked[i] == 1;then likes; else unlikes">  
                            </ng-container>                    
                                <ng-template #likes>
                                    <button  [value]="ress._id" class ="uil-heart" style="color: blue; position: relative; text-align: center;"  
                                    (click)="unLike(ress._id)" > {{ress.likers.length-1}}<span > Aimé(e) </span></button>
                                </ng-template>
                                <ng-template #unlikes >
                                        <button [value]="ress._id" class ="uil-heart" style="color: grey; ; position: relative; text-align: center;" 
                                        (click)="like(ress._id)"> {{ress.likers.length-1}}<span > Aimé(e) </span></button>
                                </ng-template>            
                            <button class="uil-share-alt" style="color: grey; ; position: relative; text-align: center;"> 193 <span> Partagé
                            </span></button>
                            <button class="uil-bookmark" style="color: grey; ; position: relative; text-align: center;"> 13 <span> Enregistré(e) </span></button>
                        </div>
                    </div>
                </div>
                
                
            </div> 
            
    
</div>
    